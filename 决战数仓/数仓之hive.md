# 数仓之hive笔记（技术都是简单的，业务才是最复杂的）
> hadoop-hbase-hive-日志分析-flume-sqoop-tez-zookeeper-redis-elasticsearch-kafka-storm-oozie---？

> 数据仓库是决策支持系统（dss）和联机分析应用数据源的结构化数据环境。数据仓库研究和解决从数据库中获取信息的问题。数据仓库的特征在于面向主题、集成性、稳定性和时变性。
## 未来的发展方向
> 数据库--->数据仓库--->数据湖--->数据中台（量变产生质变）
## hive的特性
> 面向主题(给决策支持，包含所有已知的主题相关指标)
> 集成性(将不同路径复杂的数据拿取过来的集合)
> 稳定性(数据不可更新)
> 时变性(批量)
## 数据仓库和数据库的区别
1. 数仓时面向主题、数据库是面向业务
2. 数仓是决策支持、数据库是业务支持
3. 数仓存储的是历史数据、数据库是实时数据
4. 数仓是面向决策人员、数据库是面向操作人员
## 数据分层
> 层级：（在hdfs上是对应的目录，在hive中对应的是表名）
### 为什么分层
- 清晰数据结构：每一个数据分层都有它的作用域，这样我们在使用表的时候能更方便地定位和理解。
- 数据血缘追踪：简单来讲可以这样理解，我们最终给业务诚信的是能直接使用的一张业务表，但是它的来源有很多，如果有一张来源表出现问题了，我们希望能够快速准确地定位到问题，并清楚它的危害范围。
- 减少重复开发：规模数据分层，开发一些通用的中间数据，能够极大的减少重复计算。
- 把重复问题简单化：将一个复杂的任务分解成多个步骤来完成，每一层只处理单一的步骤，比较简单和容易理解。而且便于维护数据的准确性，当数据出现问题之后，可以不用修复所有的数据，只需要从有问题的步骤开始修复。
- 屏蔽原始数据的异常。
- 屏蔽业务的影响，不必改一次业务就需要重新接入数据。
### 初始分层
- ODS全称是 Operational Data Store，操作数据存储：“面向主题的”，数据运营层，也叫ODS层，是最接近数据源中数据的一层，数据源中的数据，经过抽取、洗净、传输，也就是传说中的ETL之后，装入本层。本层的数据，总体上大多是按照源头业务系统的分类方式而分类的。但是，这一层面的数据却不等于同于原始数据。在源数据装入这一层时，要进行诸如去噪（例如有一条数据中人的年龄是300岁，这种属于异常数据，就需要提前做一些处理）、去重（例如在个人资料表中，同一ID却有两条重复数据，在接入的时候需要做一步去重）、字段名规范等一系列操作。
- 数据仓库（DW），是数据仓库的主体，在这里，从ODS层中获得的数据按照主题建立各种数据模型。这一层和维度建模会有比较深的联系，可以多参考一下前面的几篇文章。
- 数据产品层（app），这一层是提供为数据产品使用的结果数据。
### 业务分成
缓冲层（buffer）
明细层（ODS，Operational Data Store，DWD：data warehouse datail）
canal日志合成数据的方式待研究
轻度汇总层（MID或DWB，data wareshouse basis）
主题层（DM，data market或DWS，data warehouse service）
应用层（App）
### 银行数据分层
- RAW(缓冲层)
- ODS(原始数据全量表)
- MID(原始数据增量表)
- PRC(加工临时分区表)
- TMP(加工临时表)
- FCT(产品层)
## hive简介
> 基于MR处理数据，数据存储在hdfs上的一个数据仓库，使用sql来替代MR。
